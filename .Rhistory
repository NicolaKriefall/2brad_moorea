setwd('~/Google Drive/Moorea/2brad_moorea/')
library(vcfR)
library(adegenet)
library(vegan)
gl=vcfR2genlight(read.vcfR("run2.vcf"))
pops=read.table("bamscl_year.txt",sep="\t")
pop(gl)=pops$V2
pca=glPca(gl,nf=3,parallel=F)
quartz()
plot(pca$scores[,1:2],col=transp(as.numeric(as.factor(pop(gl))),0.3),pch=19)
ordispider(pca$scores[,1:2],pop(gl),col=as.numeric(as.factor(pop(gl))),label=T)
ordiellipse(pca$scores[,1:2],pops$V2,label=T,draw="polygon",col="grey90")
#pops=read.table("bamscl_year.txt",sep="\t")
pops=read.table("~/bamscl_site.txt",sep="\t")
#pops=read.table("bamscl_year.txt",sep="\t")
pops=read.table("bamscl_site.txt",sep="\t")
pop(gl)=pops$V2
pca=glPca(gl,nf=3,parallel=F)
quartz()
plot(pca$scores[,1:2],col=transp(as.numeric(as.factor(pop(gl))),0.3),pch=19)
ordispider(pca$scores[,1:2],pop(gl),col=as.numeric(as.factor(pop(gl))),label=T)
ordiellipse(pca$scores[,1:2],pops$V2,label=T,draw="polygon",col="grey90")
gl=vcfR2genlight(read.vcfR("run1.vcf"))
#pops=read.table("bamscl_year.txt",sep="\t")
pops=read.table("bamscl_site.txt",sep="\t")
pop(gl)=pops$V2
pca=glPca(gl,nf=3,parallel=F)
plot(pca$scores[,1:2],col=transp(as.numeric(as.factor(pop(gl))),0.3),pch=19)
ordispider(pca$scores[,1:2],pop(gl),col=as.numeric(as.factor(pop(gl))),label=T)
ordiellipse(pca$scores[,1:2],pops$V2,label=T,draw="polygon",col="grey90")
quartz()
plot(pca$scores[,1:2],col=transp(as.numeric(as.factor(pop(gl))),0.3),pch=19)
ordispider(pca$scores[,1:2],pop(gl),col=as.numeric(as.factor(pop(gl))),label=T)
ordiellipse(pca$scores[,1:2],pops$V2,label=T,draw="polygon",col="grey90")
gl=vcfR2genlight(read.vcfR("run2.vcf"))
#pops=read.table("bamscl_year.txt",sep="\t")
pops=read.table("bamscl_site.txt",sep="\t")
pop(gl)=pops$V2
pca=glPca(gl,nf=3,parallel=F)
quartz()
plot(pca$scores[,1:2],col=transp(as.numeric(as.factor(pop(gl))),0.3),pch=19)
ordispider(pca$scores[,1:2],pop(gl),col=as.numeric(as.factor(pop(gl))),label=T)
ordiellipse(pca$scores[,1:2],pops$V2,label=T,draw="polygon",col="grey90")
gl=vcfR2genlight(read.vcfR("run3.vcf"))
pops=read.table("bamscl_year.txt",sep="\t")
#pops=read.table("bamscl_year.txt",sep="\t")
pops=read.table("bamscl_site.txt",sep="\t")
pop(gl)=pops$V2
pca=glPca(gl,nf=3,parallel=F)
quartz()
plot(pca$scores[,1:2],col=transp(as.numeric(as.factor(pop(gl))),0.3),pch=19)
ordispider(pca$scores[,1:2],pop(gl),col=as.numeric(as.factor(pop(gl))),label=T)
ordiellipse(pca$scores[,1:2],pops$V2,label=T,draw="polygon",col="grey90")
gl=vcfR2genlight(read.vcfR("run4.vcf"))
pops=read.table("bamscl_year.txt",sep="\t")
pop(gl)=pops$V2
pca=glPca(gl,nf=3,parallel=F)
quartz()
plot(pca$scores[,1:2],col=transp(as.numeric(as.factor(pop(gl))),0.3),pch=19)
ordispider(pca$scores[,1:2],pop(gl),col=as.numeric(as.factor(pop(gl))),label=T)
ordiellipse(pca$scores[,1:2],pops$V2,label=T,draw="polygon",col="grey90")
