setwd('~/Google Drive/Moorea/2brad_moorea/Host/')
library(vcfR)
library(adegenet)
library(vegan)
gl=vcfR2genlight(read.vcfR("~/Google Drive/Moorea/Host/donresult.vcf.gz")) #output from angsd
pops=read.table("part3input_inds2pops_no8.txt",sep="\t") #bams file with a 2nd column describing variable of interest
pop(gl)=pops$V2 #you can have other columns with other variables in other columns, select which one for analysis here
pca=glPca(gl,nf=3,parallel=F) #make pca
plot(pca$scores[,1:2],col=transp(as.numeric(as.factor(pop(gl))),0.3),pch=19)
ordispider(pca$scores[,1:2],pop(gl),col=as.numeric(as.factor(pop(gl))),label=T)
ordiellipse(pca$scores[,1:2],pops$V2,label=T,draw="polygon",col="grey90")
scores <- pca$scores
adonis(scores ~ site,method='eu')
site <- pops$V2
scores <- pca$scores
adonis(scores ~ site,method='eu')
adonis(scores ~ site,method='manhattan')
ggplot(pca,aes(x=scores[,1],y=scores[,2]))
library(ggplot2)
ggplot(pca,aes(x=scores[,1],y=scores[,2]))
p1 <- ggordiplots::gg_ordiplot(ord=scores,groups=site,scaling=0.8,choices=c(1,2),conf=0.95,spiders=TRUE,pt.size=2)
plot <- p1$plot
plot + xlab('Axis1 (19.%)')+
ylab('Axis2 (14.42%)')+
scale_shape_manual(values=c(1,5))
p1 <- ggordiplots::gg_ordiplot(ord=scores,groups=site,scaling=0.8,choices=c(1,2),conf=0.95,spiders=FALSE,pt.size=2)
p1 <- ggordiplots::gg_ordiplot(ord=scores,groups=site,scaling=0.8,choices=c(1,2),conf=0.7,spiders=TRUE,pt.size=2)
p1
plot <- p1$plot
plot + xlab('Axis1 (19.%)')+
ylab('Axis2 (14.42%)')+
scale_shape_manual(values=c(1,5))
View(p1)
View(pca)
pca[["eig"]]
pca[["scores"]]
plot(pca$scores[,1:2],col=transp(as.numeric(as.factor(pop(gl))),0.3),pch=19)
ordispider(pca$scores[,1:2],pop(gl),col=as.numeric(as.factor(pop(gl))),label=T)
#nice pca
quartz()
plot(pca$scores[,1:2],col=transp(as.numeric(as.factor(pop(gl))),0.3),pch=19)
ordispider(pca$scores[,1:2],pop(gl),col=as.numeric(as.factor(pop(gl))),label=T)
ordiellipse(pca$scores[,1:2],pops$V2,label=T,draw="polygon",col="grey90")
##I didn't do, but useful:
## manually identifying outliers: click on outlier points in the plot.
## adjust n=3 parameter to identify more than 3 points
outliers=identify(pca$scores[,1:2],labels=gl@ind.names,n=3,cex=0.8)
# re-making PCA without outliers
gl2=gl[-outliers]
pca2=glPca(gl2,nf=3,parallel=F)
colors=as.numeric(as.numeric(as.factor(levels(pop(gl))))) # or use your own colors for populations
s.class(pca2$scores[],pop(gl2),col=transp(colors,0.5),cstar=1,cellipse=1,clabel=1,axesell=F,grid=F,cpoint=2)
#MDS plot/CCA:
#[from Misha's angsd_ibs_pca.R script]
setwd("~/Google Drive/Moorea/Host")
bams=read.table("bams_no8")[,1] # list of bam files
bams=read.table("bams_no8.txt")[,1] # list of bam files
bams=read.table("bams_no8.txt")[,1] # list of bam files
#MDS plot/CCA:
#[from Misha's angsd_ibs_pca.R script]
setwd("~/Google Drive/Moorea/Host")
bams=read.table("bams_no8.txt")[,1] # list of bam files
bams=read.table("bams_no8")[,1] # list of bam files
goods=c(1:length(bams))
#--------------------
# loading individual to population correspondences
i2p=read.table("part3input_inds2pops_no8",sep="\t") # 2-column tab-delimited table of individual assignments to populations; must be in the same order as samples in the bam list or vcf file.
#--------------------
# loading individual to population correspondences
i2p=read.table("part3input_inds2pops_no8.txt",sep="\t") # 2-column tab-delimited table of individual assignments to populations; must be in the same order as samples in the bam list or vcf file.
row.names(i2p)=i2p[,1]
i2p=i2p[goods,]
site=i2p[,2]
# setting up colors for plotting
palette(rainbow(length(unique(site))))
colors=as.numeric(as.factor(site))
colpops=as.numeric(as.factor(sort(unique(site))))
ma = as.matrix(read.table("donresult.ibsMat"))
ma = as.matrix(read.table("donresult.ibsMat"))
hc=hclust(as.dist(ma),"ave")
plot(hc,cex=0.5)  # this shows how similar clones are
ma=ma[goods,goods]
dimnames(ma)=list(bams[goods],bams[goods])
hc=hclust(as.dist(ma),"ave")
plot(hc,cex=0.7) # without clones
# performing PCoA and CAP
conds=data.frame(cbind(site))
pp0=capscale(ma~1)
pp=capscale(ma~site,conds)
# significance of by-site divergence
adonis(ma~site,conds)
# eigenvectors
plot(pp0$CA$eig)
axes2plot=c(1,2)
quartz()
library(adegenet) # for transp()
cmd=pp0
plot(cmd,choices=axes2plot,display="sites",type="n") # choices - axes to display
points(cmd,choices=axes2plot,pch=19,col=transp(colors,alpha=0.7))
#ordihull(cmd,choices= axes2plot,groups= conds$grp,draw="polygon",col=1+as.numeric(unique(as.factor(conds$grp))),label=T)
ordispider(cmd,choices= axes2plot,groups=conds$site,col="grey80")
ordiellipse(cmd,choices= axes2plot,groups= conds$site,draw="polygon",col=colpops,label=T)
cmd=pp
plot(cmd,choices=axes2plot,display="sites",type="n") # choices - axes to display
points(cmd,choices=axes2plot,pch=19,col=transp(colors,alpha=0.7))
#ordihull(cmd,choices= axes2plot,groups= conds$grp,draw="polygon",col=1+as.numeric(unique(as.factor(conds$grp))),label=T)
ordispider(cmd,choices= axes2plot,groups=conds$site,col="grey80")
ordiellipse(cmd,choices= axes2plot,groups= conds$site,draw="polygon",col=colpops,label=T)
cmd=pp
plot(cmd,choices=axes2plot,display="sites",type="n") # choices - axes to display
points(cmd,choices=axes2plot,pch=19,col=transp(colors,alpha=0.7))
#ordihull(cmd,choices= axes2plot,groups= conds$grp,draw="polygon",col=1+as.numeric(unique(as.factor(conds$grp))),label=T)
ordispider(cmd,choices= axes2plot,groups=conds$site,col="grey80")
ordiellipse(cmd,choices= axes2plot,groups= conds$site,draw="polygon",col=colpops,label=T)
cmd=pp0
plot(cmd,choices=axes2plot,display="sites",type="n") # choices - axes to display
points(cmd,choices=axes2plot,pch=19,col=transp(colors,alpha=0.7))
#ordihull(cmd,choices= axes2plot,groups= conds$grp,draw="polygon",col=1+as.numeric(unique(as.factor(conds$grp))),label=T)
ordispider(cmd,choices= axes2plot,groups=conds$site,col="grey80")
ordiellipse(cmd,choices= axes2plot,groups= conds$site,draw="polygon",col=colpops,label=T)
View(cmd)
View(ma)
View(pp0)
p1 <- ggordiplots::gg_ordiplot(ord=scores,groups=site,scaling=0.8,choices=c(1,2),conf=0.7,spiders=TRUE,pt.size=2)
plot <- p1$plot
names(p1)
spid <- p1$df_spiders
gl=vcfR2genlight(read.vcfR("~/Google Drive/Moorea/Host/donresult.vcf.gz")) #output from angsd
pops=read.table("part3input_inds2pops_no8.txt",sep="\t") #bams file with a 2nd column describing variable of interest
pop(gl)=pops$V2 #you can have other columns with other variables in other columns, select which one for analysis here
pca=glPca(gl,nf=3,parallel=F) #make pca
plot(pca$scores[,1:2],col=transp(as.numeric(as.factor(pop(gl))),0.3),pch=19)
ordispider(pca$scores[,1:2],pop(gl),col=as.numeric(as.factor(pop(gl))),label=T)
ordiellipse(pca$scores[,1:2],pops$V2,label=T,draw="polygon",col="grey90")
#stats
site <- pops$V2
scores <- pca$scores
adonis(scores ~ site,method='manhattan')
#ggplot pca
library(ggplot2)
p1 <- ggordiplots::gg_ordiplot(ord=scores,groups=site,scaling=0.8,choices=c(1,2),conf=0.7,spiders=TRUE,pt.size=2)
names(p1)
spid <- p1$df_spiders
p1$df_spiders
#p1$df_spiders
gg <- p1$df_ord
ggplot(gg,aes(x=x,y=y,group=Group,color=Group,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.95)+
xlab('Axis 1 (19.5%)')+
ylab('Axis 2 (14.4%)')+
theme_classic()+
theme(text=element_text(family="Gill Sans MT"))+
scale_shape_manual(values=c(21,24),labels=c("Inshore","Offshore"))+
scale_fill_manual(values=c("coral1","cyan3"),labels=c("Inshore","Offshore"))+
scale_color_manual(values=c("coral1","cyan3"),labels=c("Inshore","Offshore"))+
labs(shape="Reef zone",color="Reef zone",fill="Reef zone")
ggplot(gg,aes(x=x,y=y,group=Group,color=Group,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.95)+
xlab('Axis 1 (19.5%)')+
ylab('Axis 2 (14.4%)')+
theme_classic()+
theme(text=element_text(family="Gill Sans MT"))
ggplot(gg,aes(x=x,y=y,group=Group,color=Group,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.6)+
xlab('Axis 1 (19.5%)')+
ylab('Axis 2 (14.4%)')+
theme_classic()+
theme(text=element_text(family="Gill Sans MT"))
ggplot(gg,aes(x=x,y=y,group=Group,color=Group,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('Axis 1 (19.5%)')+
ylab('Axis 2 (14.4%)')+
theme_classic()+
theme(text=element_text(family="Gill Sans MT"))
ggplot(gg,aes(x=x,y=y,group=Group,color=Group,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('Axis 1 (19.5%)')+
ylab('Axis 2 (14.4%)')+
theme_classic()
ggplot(gg,aes(x=x,y=y,group=Group,color=Group,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('Axis 1 (4.11%)')+
ylab('Axis 2 (4.06%)')+
theme_classic()
zone <- read.table("part3input_inds2pops_zone")
zone <- read.table("part3input_inds2pops_zone.txt")
View(zone)
zone <- zones$V2 #just selecting second column
zones <- read.table("part3input_inds2pops_zone.txt") #2nd column is my reef zones instead of sites
zone <- zones$V2 #just selecting second column
dim(zone)
len(zone)
length(zone)
p1 <- ggordiplots::gg_ordiplot(ord=scores,groups=zone,scaling=0.8,choices=c(1,2),conf=0.7,spiders=TRUE,pt.size=2)
View(gg)
#change 'zone' below to 'site' if desired
p1 <- ggordiplots::gg_ordiplot(ord=scores,groups=c(zone,site),scaling=0.8,choices=c(1,2),conf=0.7,spiders=TRUE,pt.size=2)
View(p1)
#change 'zone' below to 'site' if desired
p1 <- ggordiplots::gg_ordiplot(ord=scores,groups=zone,scaling=0.8,choices=c(1,2),conf=0.7,spiders=TRUE,pt.size=2)
View(gg)
zones <- read.table("part3input_inds2pops_zone.txt") #2nd column is my reef zones instead of sites
#adding zone variable in addition to site
zones <- read.table("part3input_inds2pops_zone.txt") #2nd column is my reef zones instead of sites
zone <- zones$V2 #just selecting second column
p1 <- ggordiplots::gg_ordiplot(ord=scores,groups=site,scaling=0.8,choices=c(1,2),conf=0.7,spiders=TRUE,pt.size=2)
#names(p1)
spid <- p1$df_spiders
#p1$df_spiders
gg <- p1$df_ord
gg$zone <- zone
View(gg)
ggplot(gg,aes(x=x,y=y,group=Group,color=Group,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('Axis 1 (4.11%)')+
ylab('Axis 2 (4.06%)')+
theme_classic()+
#  theme(text=element_text(family="Gill Sans MT"))+ #to change font
#  scale_shape_manual(values=c(21,24),labels=c("Inshore","Offshore"))+
#  scale_fill_manual(values=c("coral1","cyan3"),labels=c("Inshore","Offshore"))+
#  scale_color_manual(values=c("coral1","cyan3"),labels=c("Inshore","Offshore"))+
#  labs(shape="Reef zone",color="Reef zone",fill="Reef zone")
#####MDS plot/CCA from IBS matrix:#####
#[from Misha's angsd_ibs_pca.R script]
setwd("~/Google Drive/Moorea/Host")
ggplot(gg,aes(x=x,y=y,group=Group,color=Group,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('Axis 1 (4.11%)')+
ylab('Axis 2 (4.06%)')+
theme_classic()
ggplot(gg,aes(x=x,y=y,group=Group,color=Group,shape=zone,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('Axis 1 (4.11%)')+
ylab('Axis 2 (4.06%)')+
theme_classic()
ggplot(gg,aes(x=x,y=y,group=zone,color=zone,shape=Group,fill=zone))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('Axis 1 (4.11%)')+
ylab('Axis 2 (4.06%)')+
theme_classic()
ggplot(gg,aes(x=x,y=y,group=Group,color=Group,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('Axis 1 (4.11%)')+
ylab('Axis 2 (4.06%)')+
theme_classic()
ggplot(gg,aes(x=x,y=y,group=Group,color=Group,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()
ggplot(gg,aes(x=x,y=y,group=Group,color=zone,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()
ggplot(gg,aes(x=x,y=y,group=Group,color=zone,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))
p1 <- ggordiplots::gg_ordiplot(ord=scores,groups=site,scaling=0.8,choices=c(1,2),conf=0.7,spiders=FALSE,pt.size=2)
#names(p1)
spid <- p1$df_spiders
#p1$df_spiders
gg <- p1$df_ord
gg$zone <- zone
quartz()
ggplot(gg,aes(x=x,y=y,group=Group,color=zone,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))
ggplot(gg,aes(x=x,y=y,group=Group,color=zone,shape=Group,fill=Group))+
geom_point(size=2)+
#  geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))
ggplot(gg,aes(x=x,y=y,group=Group,color=zone,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))
#adding more reef info
reef <- read.table("part3input_inds2pops_reef.txt")
#adding more reef info
reefs <- read.table("part3input_inds2pops_reef.txt")
reef <- reefs$V2
gg$reef <- reef
ggplot(gg,aes(x=x,y=y,group=Group,color=zone,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))+
scale_shape_manual(values=c(21,24),labels=c("Inshore","Offshore"))+
#  theme(text=element_text(family="Gill Sans MT"))+ #to change font
#  scale_fill_manual(values=c("coral1","cyan3"),labels=c("Inshore","Offshore"))+
#  labs(shape="Reef zone",color="Reef zone",fill="Reef zone")
#####MDS plot/CCA from IBS matrix:#####
#[from Misha's angsd_ibs_pca.R script]
setwd("~/Google Drive/Moorea/Host")
ggplot(gg,aes(x=x,y=y,group=Group,color=zone,shape=Group,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))+
scale_shape_manual(values=c(21,24,25),labels=c("MNW","MSE","TNW"))
ggplot(gg,aes(x=x,y=y,group=Group,color=zone,shape=reef,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))+
scale_shape_manual(values=c(21,24,25),labels=c("MNW","MSE","TNW"))
ggplot(gg,aes(x=x,y=y,group=reef,color=zone,shape=reef,fill=Group))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))+
scale_shape_manual(values=c(21,24,25),labels=c("MNW","MSE","TNW"))
ggplot(gg,aes(x=x,y=y,group=reef,color=zone,shape=reef,fill=zone))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))+
scale_shape_manual(values=c(21,24,25),labels=c("MNW","MSE","TNW"))
ggplot(gg,aes(x=x,y=y,group=Group,color=zone,shape=reef,fill=zone))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))+
scale_shape_manual(values=c(21,24,25),labels=c("MNW","MSE","TNW"))
ggplot(gg,aes(x=x,y=y,group=Group,color=zone,shape=reef,fill=zone))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))+
scale_shape_manual(values=c(21,24,25),labels=c("MNW","MSE","TNW"))
ggplot(gg,aes(x=x,y=y,group=Group,color=zone,shape=reef))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))+
scale_shape_manual(values=c(21,24,25),labels=c("MNW","MSE","TNW"))
ggplot(gg,aes(x=x,y=y,group=Group,color=zone,shape=reef))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8,line=reef)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))+
scale_shape_manual(values=c(21,24,25),labels=c("MNW","MSE","TNW"))
ggplot(gg,aes(x=x,y=y,group=Group,color=zone,shape=reef))+
geom_point(size=2)+
geom_segment(data=p1$df_spiders, aes(x=x, y=y, xend=cntr.x, yend=cntr.y))+
stat_ellipse(level=0.8,linetype=reef)+
xlab('PC1 (4.11%)')+
ylab('PC2 (4.06%)')+
theme_classic()+
scale_color_manual(values=c("#ED7953FF","#8405A7FF"),labels=c("Backreef","Forereef"))+
scale_shape_manual(values=c(21,24,25),labels=c("MNW","MSE","TNW"))
